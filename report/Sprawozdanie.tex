\documentclass[a4paper,titlepage,11pt,floatssmall]{mwrep}
\usepackage[left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm]{geometry}
\usepackage[OT1]{fontenc}
\usepackage{polski}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{rotating}
\usepackage{pgfplots}
\usetikzlibrary{pgfplots.groupplots}

\usepackage{siunitx}

\usepackage{float}
\definecolor{szary}{rgb}{0.95,0.95,0.95}
\sisetup{detect-weight,exponent-product=\cdot,output-decimal-marker={,},per-mode=symbol,binary-units=true,range-phrase={-},range-units=single}

\SendSettingsToPgf
\title{\bf Sprawozdanie z projektu nr 2\\ Zadanie nr 36  \vskip 0.1cm}
\author{Jakub Sikora \and nr albumu 283418}
\date{\today}
\pgfplotsset{compat=1.15}	
\begin{document}


\makeatletter
\renewcommand{\maketitle}{\begin{titlepage}
		\begin{center}{\LARGE {\bf
					Wydział Elektroniki i Technik Informacyjnych}}\\
			\vspace{0.4cm}
			{\LARGE {\bf Politechnika Warszawska}}\\
			\vspace{0.3cm}
		\end{center}
		\vspace{5cm}
		\begin{center}
			{\bf \LARGE Modelowanie i identyfikacja \vskip 0.1cm}
		\end{center}
		\vspace{1cm}
		\begin{center}
			{\bf \LARGE \@title}
		\end{center}
		\vspace{2cm}
		\begin{center}
			{\bf \Large \@author \par}
		\end{center}
		\vspace*{\stretch{6}}
		\begin{center}
			\bf{\large{Warszawa, \@date\vskip 0.1cm}}
		\end{center}
	\end{titlepage}
	}
\makeatother
\maketitle

\tableofcontents

\chapter{Zadania obowiązkowe}

\section{Identyfikacja modeli statycznych}

\subsection{Wykres danych statycznych}

\indent Na rysunku poniżej przedstawiłem dane z pliku \texttt{danestat36.txt}. Na osi poziomej przedstawiłem sterowanie, które zmienia się w przedziale $[-1; 1]$. Na osi pionowej wykresu znajduje się wyjście procesu, które jest zmienne w zakresie $[-3,1; 0,25]$. Na pierwszy rzut oka można stwierdzić że badany proces jest nieliniowy i co najmniej 3 rzędu.
\bigskip
\begin{figure}[H]
\centering
\includegraphics[width = \textwidth]{../figures/stat/dane_overall.pdf}
\caption{Przedstawienie statycznych danych pomiarowych}
\end{figure}


\newpage
\subsection{Podział na zbiór uczący i weryfikujący}
\indent W celu identyfikacji modelu metodą najmniejszych kwadratów, najpierw należy dokonać podziału zbioru danych na zbiór uczący i zbiór weryfikujący. Najprostszą metodą podziału z której powinniśmy uzyskać dwa równomierne zbioru, jest przyporządkowywanie rekordu z posortowanego zbioru danych na zmianę raz do zbioru uczącego a raz do zbioru weryfikującego. Za pomocą matlaba (skrypt \texttt{stat/zad\_{}b.m} dokonałem prostego podziału. Oba zbiory przedstawiłem na rysunkach poniżej.

\begin{figure}[H]
\centering
\includegraphics[width = 0.75\textwidth]{../figures/stat/dane_ucz.pdf}
\caption{Zbiór danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.75\textwidth]{../figures/stat/dane_wer.pdf}
\caption{Zbiór danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = \textwidth]{../figures/stat/dane_comp.pdf}
\caption{Porównanie zbiorów: weryfikującego i uczącego.}
\end{figure}

\indent Na podstawie rysunku 1.4, można stwierdzić że uzyskany podział jest wystarczająco równomierny. 

\subsection{Statyczny model liniowy}
\indent Wykorzystując zbiór danych uczących można przystąpić do identyfikacji statycznego modelu liniowego postaci:
\begin{equation*}
y(u) = w_1u + w_0
\end{equation*}
gdzie $w_0$, $w_1$ są współczynnikami uzyskanymi za pomocą metody najmniejszych kwadratów. W ogólności, metoda ta polega na minimalizacji błędu średniokwadratowego modelu:
\begin{equation*}
\min_{w} \sum_{i=1}^{P} (y_i - y_i^{mod})^2
\end{equation*}
Za pomocą tej metody możemy zidentyfikować model o dowolnym rzędzie, który będzie najlepiej dopasowany do danych. W tym zadaniu skupiłem się jednak tylko na modelu liniowym. Poszukiwany wektor współczynników:
$$
\mathbf{w} =
\left[\begin{array}{c}
w_1 \\
w_0 \\
\end{array} \right]
$$
\newpage

W celu wyznaczenia wektora $w$, zapisałem nadokreślny układ równań, czyli taki który ma więcej równań niż zmiennych. 

$$
\left[\begin{array}{c}
y_1 \\
y_2 \\
\vdots \\
y_P
\end{array} \right] 
=
\left[ \begin{array}{cc}
u_1 & 1  \\
u_2 & 1 \\
\vdots & \vdots \\
u_P & 1\\
\end{array} \right]
\left[\begin{array}{c}
w_1 \\
w_0 \\
\end{array} \right]
$$

Co można w skrócie zapisać:
\begin{equation*}
Y = Mw
\end{equation*}

W matlabie, liniowe zadanie najmniejszych kwadratów można rozwiązać za pomocą operatora lewego dzielenia:
\begin{equation*}
w = M \setminus Y
\end{equation*}

Identyfikacja modelu powinna odbywać się tylko przy pomocy zbioru danych uczących. Dane weryfikujące powinny służyć tylko i wyłącznie do walidacji modelu. W przypadku gdy chcemy uzyskać bardziej dokładne modele możemy skorzystać z walidacji k-krotnej zwanej też sprawdzianem krzyżowym. W takim przypadku z zbiór danych dzielimy na $k$ podzbiorów i dla każdego podzbioru identyfikujemy model, następnie sprawdzamy go z pozostałymi $k-1$ podzbiorami tak aby na końcu wybrać średnią ważoną z wszystkich modeli. W ramach tego projektu ograniczę się jednak do zwykłej metody podziału na zbiór uczący i weryfikujący. Do identyfikacji skorzystałem z podziału na podzbiory wyznaczonego w poprzednim zadaniu.\\
\indent Za pomocą skryptu \texttt{stat/zad\_{}d.m} uzyskałem następujące wartości współczynników:
$$
\left[\begin{array}{c}
w_1 \\
w_0 \\
\end{array} \right]
= 
\left[\begin{array}{c}
-0,59424 \\
-1,0778 \\
\end{array} \right]
$$

Model liniowy jest postaci:
\begin{equation*}
y = -0,59424u -1,0778 
\end{equation*}

\begin{figure}[H]
\centering
\includegraphics[width = 0.80\textwidth]{../figures/stat/lin_mod_ucz_comp.pdf}
\caption{Model liniowy na tle danych uczących}
\end{figure}

Uzyskany błąd średniokwadratowy dla zbioru uczącego wyniósł $E_{ucz} = 78,0732$. Już dla zbioru uczącego widać że model bardzo źle przybliża opisywany proces.

\indent O wiele bardziej interesujące jest zachowanie uzyskanego modelu w porównaniu do danych ze zbioru weryfikującego. Na podstawie błędu modelu możemy uzyskać informację o realnej przydatności modelu.
\begin{figure}[H]
\centering
\includegraphics[width = 0.80\textwidth]{../figures/stat/lin_mod_wer_comp.pdf}
\caption{Model liniowy na tle danych weryfikujących}
\end{figure}

W tym przypadku błąd średniokwadratowy wzrósł do wartości $E_{wer} = 97,1835$. O przydatności (a raczej o jej braku) modelu dużo można powiedzieć na podstawie samego wykresu. Widać że model liniowy w żadnym stopniu nie aproksymuje danych pomiarowych, przez co jego użyteczność jest niewielka.  
\newpage 
Kolejnym sposobem na weryfikację modelu, jest narysowanie wykresu odpowiedzi modelu od rzeczywistych danych pomiarowych, czyli porównanie odpowiedzi rzeczywistej i wyniku modelu dla tych samych wartości $u$. W przypadku idealnym wykres powinien ułożyć się w prostą nachyloną pod kątem $45^{\circ}$
\begin{figure}[H]
\centering
\includegraphics[width = 0.80\textwidth]{../figures/stat/lin_mod_od_danych.pdf}
\caption{Porównanie odpowiedzi procesu i odpowiedzi modelu}
\end{figure}
Jak widać na rysunku 1.7, odpowiedź modelu liniowego jest niewspółmierna z rzeczywistymi danymi. W kolejnych zadaniach będę rozważał modele nieliniowe, które powinny znacznie lepiej opisywać ten proces.

\subsection{Statyczne modele nieliniowe}

W przypadku podanych danych, o wiele lepiej sprawdziłyby się modele nieliniowe. Za pomocą skryptu \texttt{static/zad\_d.m} zidentyfikowałem modele rzędu większego niż 1. 

\subsubsection{Model kwadratowy}

Pierwszym rozważanym przeze mnie modelem jest model rzędu drugiego opisany wzorem: 

\begin{equation*}
y(u) = w_2u^2 + w_1u + w_0
\end{equation*}

Wyznaczony wektor współczynników:

$$
\left[\begin{array}{c}
w_0 \\
w_1 \\
w_2 \\
\end{array} \right]
= 
\left[\begin{array}{c}
-0,1192	\\
-0,2390 \\
-2,7422 \\
\end{array} \right]
$$

\newpage

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_ucz_comp_r_2.pdf}
\caption{Model drugiego rzędu na tle danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_wer_comp_r_2.pdf}
\caption{Model drugiego rzędu na tle danych weryfikujących}
\end{figure}

\newpage

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_od_danych_r_2.pdf}
\caption{Porównanie odpowiedzi procesu i odpowiedzi modelu}
\end{figure}

Jak widać na powyższych wykresach, model kwadratowy znacznie lepiej opisuje zadany proces. Błąd uczący jak i błąd weryfikujący zmalały o rząd wielkości i wynoszą teraz $E_{ucz} = 7,7713$ i $E_{wer} = 7,4373$, a wykres odpowiedzi modelu do danych rzeczywistych zaczyna przypominać prostą.

\subsubsection{Model trzeciego rzędu}

Model trzeciego rzędu opisany jest wzorem:

\begin{equation*}
y(u) = w_3u^3 + w_2u^2 + w_1u + w_0
\end{equation*}

Wyznaczony wektor współczynników:

$$
\left[\begin{array}{c}
w_0 \\
w_1 \\
w_2 \\
w_3 \\
\end{array} \right]
= 
\left[\begin{array}{c}
-0,1183	\\
-1,2736 \\
-2,8837 \\
1,6696 \\ 
\end{array} \right]
$$

\newpage

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_ucz_comp_r_3.pdf}
\caption{Model trzeciego rzędu na tle danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_wer_comp_r_3.pdf}
\caption{Model trzeciego rzędu na tle danych weryfikujących}
\end{figure}

\newpage

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_od_danych_r_3.pdf}
\caption{Porównanie odpowiedzi procesu i odpowiedzi modelu}
\end{figure}

Zgodnie z oczekiwaniami, model trzeciego rzędu jeszcze lepiej opisuje rzeczywisty proces. Błędy uczący weryfikujący zmalały i wynoszą teraz $E_{ucz} = 1,5862$ i $E_{wer} = 1,5327$. Kontrolny wykres odpowiedzi modelu od danych procesu przypomina już w dużej mierze prostą nachyloną pod kątem czterdziestu pięciu stopni. Model ten można by uznać za zadowalający jednak w przedziale sterowań $[0,6 ; 1]$ odpowiedź modelu jeszcze nie do końca odpowiada danym rzeczywistym. Można to poprawić stosując model wyższego rzędu.

\subsubsection{Model czwartego rzędu}

Model czwartego rzędu opisany jest wzorem:

\begin{equation*}
y(u) = w_4u^4 + w_3u^3 + w_2u^2 + w_1u + w_0
\end{equation*}

Wyznaczony wektor współczynników:

$$
\left[\begin{array}{c}
w_0 \\
w_1 \\
w_2 \\
w_3 \\
w_4 \\
\end{array} \right]
= 
\left[\begin{array}{c}
-0,0050	\\
-1,2565 \\
-4,0568 \\
1,5953 \\
1,3547 \\ 
\end{array} \right]
$$

\newpage

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_ucz_comp_r_4.pdf}
\caption{Model czwartego rzędu na tle danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_wer_comp_r_4.pdf}
\caption{Model czwartego rzędu na tle danych weryfikujących}
\end{figure}

\newpage

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_od_danych_r_4.pdf}
\caption{Porównanie odpowiedzi procesu i odpowiedzi modelu}
\end{figure}

Stosując model czwartego rzędu udało się zminimalizować błąd modelu w przedziale $[0,6 ; 1]$ o którym mowa było w przypadku poprzedniej wersji modelu. Błędy uczący weryfikujący zmalały i wynoszą teraz $E_{ucz} = 0,44789 $ i $E_{wer} = 0,49636$. Wykres kontrolny (1.16) świadczy o doskonałej poprawności modelu. 

\subsubsection{Model piątego rzędu}
Model piątego rzędu opisany jest wzorem:

\begin{equation*}
y(u) = w_5u^5 + w_4u^4 + w_3u^3 + w_2u^2 + w_1u + w_0
\end{equation*}

Wyznaczony wektor współczynników:

$$
\left[\begin{array}{c}
w_0 \\
w_1 \\
w_2 \\
w_3 \\
w_4 \\
w_5 \\
\end{array} \right]
= 
\left[\begin{array}{c}
-0,0046	\\
-1,1810 \\
-4,0509 \\
1,2576 \\
1,3542 \\
0,2973 \\ 
\end{array} \right]
$$

\newpage

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_ucz_comp_r_5.pdf}
\caption{Model piątego rzędu na tle danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_wer_comp_r_5.pdf}
\caption{Model piątego rzędu na tle danych weryfikujących}
\end{figure}

\newpage

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_od_danych_r_5.pdf}
\caption{Porównanie odpowiedzi procesu i odpowiedzi modelu}
\end{figure}

Zwiększenie rzędu modelu w tym przypadku nie przyniosło oczekiwanych rezultatów. Błędy uczący i weryfikujący utrzymają się na mniej więcej stałym poziomie. Model jest bardzo dokładny ale zwiększyła się jego złożoność numeryczna. Znacznie prościej i szybciej jest obliczać wartość wielomianu rzędów niższych, co w  prostych sterownikach opartych na mikrokontrolerach w których zdolność obliczeniowa jest ograniczona może mieć kolosalne znaczenie.

\subsubsection{Model dziesiątego rzędu}
Model dziesiątego rzędu opisany jest wzorem:

\begin{equation*}
y(u) = w_{10}u^{10} + w_9u^9 + w_8u^8 + w_7u^7 + w_6u^6 + w_5u^5 + w_4u^4 + w_3u^3 + w_2u^2 + w_1u + w_0
\end{equation*}

Wyznaczony wektor współczynników:

$$
\left[\begin{array}{c}
w_0 \\
w_1 \\
w_2 \\
w_3 \\
w_4 \\
w_5 \\
w_6 \\
w_7 \\
w_8 \\
w_9 \\
w_{10} \\
\end{array} \right]
= 
\left[\begin{array}{c}
-0,0125	\\
-1,1545 \\
-3,9583 \\
1,0097 \\
1,9790 \\
0,9129 \\
-3,5286 \\
-0,4370 \\
4,7574 \\
0,0213 \\
-1,8973 \\
\end{array} \right]
$$

\newpage

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_ucz_comp_r_10.pdf}
\caption{Model dziesiątego rzędu na tle danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_wer_comp_r_10.pdf}
\caption{Model dziesiątego rzędu na tle danych weryfikujących}
\end{figure}

\newpage

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/stat/mod_od_danych_r_10.pdf}
\caption{Porównanie odpowiedzi procesu i odpowiedzi modelu}
\end{figure}

Ostatni eksperyment przeprowadziłem dla modelu rzędu dziesiątego. Pomimo dużego rzędu wielomianu, błąd uczący i weryfikujący jest porównywalny z błędami modelu czwartego rzędu. Zupełny brak zwiększenia dokładności jest niewspółmierny z dużym wzrostem złożoności obliczeniowej. 

\newpage

\subsection{Porównanie zidentyfikowanych modeli}

W tabeli poniżej porównałem błąd uczący i błąd weryfikujący wszystkich rozważanych modeli.
\bigskip
\begin{center}


\begin{tabular}{|c|c|c|}
  \hline 
  Rząd modelu & Błąd uczący & Błąd weryfikujący \\
  \hline
  1 & $78,0732$ & $97,1835$ \\
  \hline
  2 & $7,7713$ & $7,4373$ \\
  \hline
  3 & $1,5862$ & $1,5327$ \\
  \hline
  4 & $0,44789$ & $0,39636$ \\
  \hline
  5 & $0,43602$ & $0,40163$ \\
  \hline
  10 & $0,41899$ & $0,41433$ \\
  \hline
\end{tabular} 
\end{center}

\bigskip
Wybierając model do dalszych zastosowań należy kierować się dwoma względami. Wybrany model powinien mieć jak najmniejszy błąd weryfikujący oraz powinien być jak najniższego rzędu. W przypadku przeprowadzonej identyfikacji, wybór ostatecznego modelu statycznego jest sprawą prostą. Najniższy błąd osiągnięty został dla modelu rzędu czwartego. Taki model ma relatywnie niski rząd i jego obliczanie nie jest procedurą złożoną. Dlatego też do projektowania dalszych rozwiązań dla tego procesu (regulatory, obserwatory itp.) wykorzystałbym model rzędu czwartego postaci: 

\begin{equation*}
y(u) = 1,3547u^4 + 1,5953u^3 - 4,0568u^2 - 1,2565u - 0, 0050
\end{equation*}

\newpage
\section{Identyfikacja modeli dynamicznych}
Metoda najmniejszych kwadratów może również służyć do identyfikacji modeli dynamicznych. W tym celu również wymagane są dwa zbiory danych: uczące i weryfikujące, jednak format tych danych jest zgoła odmienny niż w przypadku modeli statycznych. Zbiór danych musi być uporządkowany w czasie aby poprawnie reprezentować dynamikę procesu.

\subsection{Zbiory danych}
\subsubsection{Dane uczące}
\bigskip
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/dane_dyn_ucz_u.pdf}
\caption{Przebieg sygnału sterującego}
\end{figure}
\newpage

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/dane_dyn_ucz_y.pdf}
\caption{Przebieg sygnału wyjściowego}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/dane_dyn_ucz_both.pdf}
\caption{Porównanie obu sygnałów}
\end{figure}

\subsubsection{Dane weryfikujące}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/dane_dyn_wer_u.pdf}
\caption{Przebieg sygnału sterującego}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/dane_dyn_wer_y.pdf}
\caption{Przebieg sygnału wyjściowego}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/dane_dyn_wer_both.pdf}
\caption{Porównanie obu sygnałów}
\end{figure}

Na pierwszy rzut oka łatwo stwierdzić że badany proces jest mocno nieliniowy. Zależność między poszczególnymi zmianami sygnału wyjściowego w porównaniu do zmian sygnału sterującego nie są proporcjonalne.  

\subsection{Dynamiczne modele liniowe}
W ramach kolejnego zadania wyznaczyłem szereg modeli liniowych postaci:

\begin{equation*}
y[k] = \sum_{i=1}^{n_B} b_i u[k-i] + \sum_{i=1}^{n_A} a_i y[k-i]
\end{equation*}

Podobnie jak w przypadku modeli statycznych zapisałem zadanie najmniejszych kwadratów, jednak w postaci pozwalającej na identyfikację modeli dynamicznych. Dla modeli pierwszego rzędu zadanie jest następującej postaci

$$
\left[\begin{array}{c}
y[1] \\
y[2] \\
\vdots \\
y_[P]
\end{array} \right] 
=
\left[ \begin{array}{cc}
u[0] & y[0]  \\
u[1] & y[1] \\
\vdots & \vdots \\
u[P-1] & y[P-1]\\
\end{array} \right]
\left[\begin{array}{c}
w_1 \\
w_0 \\
\end{array} \right]
$$,

co można w skrócie zapisać:
\begin{equation*}
Y = Mw
\end{equation*}

Dla modeli $n$-tego rzędu macierz $M$ będzie postaci:
$$
\left[\begin{array}{c}
y[1] \\
y[2] \\
\vdots \\
y_[P]
\end{array} \right] 
=
\left[ \begin{array}{cccccc}
u[0] & \hdots & u[-n] & y[0] & \hdots & y[-n] \\
u[1] & \hdots & u[-n+1] & y[1] & \hdots & y[-n+1] \\
\vdots & \vdots & \vdots & \vdots & \vdots & \vdots \\
u[P-1] & \hdots & u[P-n-1] & y[P-1] & \hdots & y[P-n-1] \\
\end{array} \right]
\left[\begin{array}{c}
w_1 \\
w_0 \\
\end{array} \right]
$$

\newpage

\subsubsection{Model pierwszego rzędu}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_arx_ucz_1.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_oe_ucz_1.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_arx_wer_1.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_oe_wer_1.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Model drugiego rzędu}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_arx_ucz_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_oe_ucz_2.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_arx_wer_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_oe_wer_2.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Model trzeciego rzędu}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_arx_ucz_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_oe_ucz_3.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_arx_wer_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_oe_wer_3.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Komentarz do wyników}
W tabeli poniżej znajduje się zestawienie wszystkich uzyskanych wartości błędów dla zadanych modeli.


\begin{table}[H]
\centering
\caption{Błędy modeli dla zadanych rzędów}
\begin{tabular}{|l|l|l|l|l|}
\hline
Rząd modelu &$ E_{ucz}^{ARX}$     & $E_{ucz}^{OE}$    & $E_{wer}^{ARX}$     &$ E_{wer}^{OE} $    \\ \hline
1           & 2,046683 & 3333,513 & 1,740251 & 3917,316 \\ \hline
2           & 0,235764 & 3351,900 & 0,238069 & 3597,633 \\ \hline
3           & 0,212108 & 3327,520 & 0,203074 & 3573,873 \\ \hline
\end{tabular}
\end{table}

Poniższe dane uznałem za niesatysfakcjonujące. Najlepszy model wyszedł dla najwyższego badanego rzędu, dlatego też przeprowadziłem dalsze eksperymenty dla modeli wyższych rzędów.

\begin{table}[H]
\centering
\caption{Rozszerzona tabela z uzyskanymi błędami modeli}
\begin{tabular}{|l|l|l|l|l|}
\hline
Rząd modelu & $E_{ucz}^{ARX}$     & $E_{ucz}^{OE} $    &$ E_{wer}^{ARX} $    & $E_{wer}^{OE}$     \\ \hline
1           & 2,046683 & 3333,513 & 1,740251 & 3917,316 \\ \hline
2           & 0,235764 & 3351,900 & 0,238069 & 3597,633 \\ \hline
3           & 0,212108 & 3327,520 & 0,203074 & 3573,873 \\ \hline
4           & 0,208349 & 3327,278 & 0,198302 & 3521,722 \\ \hline
5           & 0,196541 & 3338,107 & 0,188608 & 3489,212 \\ \hline
6           & 0,192738 & 3350,215 & 0,183241 & 3500,315 \\ \hline
7           & 0,192429 & 3351,484 & 0,184338 & 3528,152 \\ \hline
8           & 0,192302 & 3347,851 & 0,184251 & 3513,736 \\ \hline
9           & 0,192214 & 3349,431 & 0,184073 & 3520,368 \\ \hline
10          & 0,192063 & 3345,570 & 0,184269 & 3513,926 \\ \hline
\end{tabular}
\end{table}

Najmniejszy błąd weryfikacyjny dla modelu z rekurencją uzyskałem dla modelu piątego rzędu. Dodatkowo, ilość parametrów tego modelu jest relatywnie mała. 

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_arx_ucz_5.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_oe_ucz_5.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_arx_wer_5.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/lindyn_oe_wer_5.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

Równanie modelu:

$$ 
y[k] = 
\left[\begin{array}{c}
   -0.0015 \\
   -0.0015 \\ 
   -0.0013 \\
    0.0006 \\
    0.0035 \\
    1.6517 \\
   -0.1594 \\
   -0.4595 \\
   -0.2687 \\
    0.2353 \\
\end{array} \right]
\cdot
\left[\begin{array}{c}
   u[k-1] \\
   u[k-2] \\
   u[k-3] \\ 
   u[k-4] \\ 
   u[k-5] \\ 
   y[k-1] \\ 
   y[k-2] \\ 
   y[k-3] \\ 
   y[k-4] \\ 
   y[k-5] \\
\end{array} \right]^T
$$


Wartość błędu weryfikującego dla modelu piątego rzędu z rekurencją wskazuje na dużą niedokładność modelu. Świadczy to o mocnej nieliniowości procesu. Aby dokładniej zamodelować badane zjawisko należy posłużyć się modelami nieliniowymi.

\newpage
\subsection{Dynamiczne modele nieliniowe}
W następnym zadaniu posłużyłem się metodą najmniejszych kwadratów w celu wyznaczenia kilkunastu modeli wielomianowych. Modele są postaci:

\begin{equation*}
	y[k] = \sum_{i=1}^{n_B} \sum_{n=1}^{m} b_i (	u[k-i])^n + \sum_{i=1}^{n_A} \sum_{n=1}^{m} a_i (y[k-i])^n
\end{equation*}

Modele wielomianowe pierwszego stopnia zostały omówione w poprzedniej sekcji, dlatego też rozpocznę od modeli kwadratowych.

\subsection{Modele kwadratowe}
Na pierwszy rzut oka można stwierdzić że dodanie członów nieliniowych do równania modelu znacząco poprawia jego jakość. Błędy znacznie zmalały, choć nadal są dalekie od pożądanych. 

\begin{table}[H]
\centering
\caption{Błędy modeli wielomianowych stopnia drugiego}
\begin{tabular}{|l|l|l|l|l|l|}
\hline
Rząd modelu & Stopień wielomianu & $ E_{ucz}^{ARX}$     & $E_{ucz}^{OE}$    & $E_{wer}^{ARX}$     &$ E_{wer}^{OE} $    \\ \hline
1           & 2                  & 0,739256 & 95,27229 & 0,8569819  & 143,8209 \\ \hline
2           & 2                  & 0,168894 & 63,64604 & 0,2019453  & 105,8382 \\ \hline
3           & 2                  & 0,137727 & 61,41986 & 0,1624305  & 98,17335 \\ \hline
4           & 2                  & 0,126977 & 61,70969 & 0,1421674  & 95,45892 \\ \hline
5           & 2                  & 0,110351 & 60,58081 & 0,1197865  & 94,30556 \\ \hline
6           & 2                  & 0,094504 & 58,01698 & 0,1024341 & 94,130600 \\ \hline
7           & 2                  & 0,087338 & 54,55316 & 0,0942585 & 95,136858 \\ \hline
\end{tabular}
\end{table}

\newpage
\subsubsection{Dynamika pierwszego rzędu}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_ucz_1_deg_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_ucz_1_deg_2.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_wer_1_deg_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_wer_1_deg_2.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Dynamika drugiego rzędu}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_ucz_2_deg_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_ucz_2_deg_2.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_wer_2_deg_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_wer_2_deg_2.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Dynamika trzeciego rzędu}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_ucz_3_deg_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_ucz_3_deg_2.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_wer_3_deg_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_wer_3_deg_2.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Dynamika czwartego rzędu}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_ucz_4_deg_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_ucz_4_deg_2.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_wer_4_deg_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_wer_4_deg_2.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Dynamika piątego rzędu}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_ucz_5_deg_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_ucz_5_deg_2.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_wer_5_deg_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_wer_5_deg_2.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Dynamika szóstego rzędu}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_ucz_6_deg_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_ucz_6_deg_2.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_wer_6_deg_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_wer_6_deg_2.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Dynamika siódmego rzędu}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_ucz_7_deg_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_ucz_7_deg_2.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_wer_7_deg_2.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_wer_7_deg_2.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

Dodanie członów nieliniowych do równania modelu znacząco poprawia jego jakość. Błędy znacznie zmalały, choć nadal są dalekie od pożądanych. 

\subsection{Modele stopnia trzeciego}
W kolejnym eksperymencie sprawdziłem czy modele stopnia trzeciego okażą się lepsze od modeli kwadratowych.

\begin{table}[H]
\centering
\caption{Błędy modeli wielomianowych stopnia trzeciego}
\begin{tabular}{|l|l|l|l|l|l|}
\hline
Rząd modelu & Stopień wielomianu & $E_{ucz}^{ARX}$    & $E_{ucz}^{OE}$   & $E_{wer}^{ARX}$    & $E_{wer}^{OE}$   \\ \hline
1           & 3                  & 0,560965 & 26,5574 & 0,476535 & 16,9293 \\ \hline
2           & 3                  & 0,124306 & 7,40536 & 0,145040 & 7,10195 \\ \hline
3           & 3                  & 0,088825 & 6,09822 & 0,096317 & 5,61037 \\ \hline
4           & 3                  & 0,082060 & 5,95233 & 0,088810 & 6,02414 \\ \hline
5           & 3                  & 0,079970 & 5,94520 & 0,088762 & 6,44954 \\ \hline
6           & 3                  & 0,073956 & 5,83669 & 0,087062 & 6,83701 \\ \hline
7           & 3                  & 0,068307 & 5,87967 & 0,083175 & 7,54866 \\ \hline
\end{tabular}
\end{table}

\newpage
\subsubsection{Dynamika pierwszego rzędu}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_ucz_1_deg_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_ucz_1_deg_3.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_wer_1_deg_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_wer_1_deg_3.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Dynamika drugiego rzędu}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_ucz_2_deg_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_ucz_2_deg_3.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_wer_2_deg_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_wer_2_deg_3.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Dynamika trzeciego rzędu}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_ucz_3_deg_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_ucz_3_deg_3.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_wer_3_deg_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_wer_3_deg_3.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Dynamika czwartego rzędu}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_ucz_4_deg_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_ucz_4_deg_3.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_wer_4_deg_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_wer_4_deg_3.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Dynamika piątego rzędu}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_ucz_5_deg_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_ucz_5_deg_3.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_wer_5_deg_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_wer_5_deg_3.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Dynamika szóstego rzędu}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_ucz_6_deg_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_ucz_6_deg_3.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_wer_6_deg_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_wer_6_deg_3.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsubsection{Dynamika siódmego rzędu}
\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_ucz_7_deg_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_ucz_7_deg_3.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_arx_wer_7_deg_3.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlindyn_oe_wer_7_deg_3.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

Modele trzeciego rzędu dobrze radzą sobie z nieliniowym procesem. Błędy modelu ARX są minimalne a błędy modelu z rekurencją osiągają akceptowalny poziom.
\newpage
\subsection{Modele wyższych stopni}

W ramach projektu przebadałem modele wielomianowe do siódmego stopnia. Błędy tych modeli znajdują się w tabeli poniżej.

\begin{table}[H]
\centering
\caption{Błędy modeli wielomianowych wyższych rzędów}
\begin{tabular}{|l|l|l|l|l|l|}
\hline
Rząd modelu & Stopień wielomianu & $E_{ucz}^{ARX}$    & $E_{ucz}^{OE}$     & $E_{wer}^{ARX}$    & $E_{wer}^{OE}$    \\ \hline
1           & 1             & 2,046683 & 3333,5138 & 1,740251 & 3917,316  \\ \hline
2           & 1             & 0,235764 & 3351,9007 & 0,238069 & 3597,633  \\ \hline
3           & 1             & 0,212108 & 3327,5209 & 0,203074 & 3573,873  \\ \hline
4           & 1             & 0,208349 & 3327,2780 & 0,198302 & 3521,722 \\ \hline
5           & 1             & 0,196541 & 3338,1071 & 0,188608 & 3489,212 \\ \hline
6           & 1             & 0,192738 & 3350,2155 & 0,183241 & 3500,315  \\ \hline
7           & 1             & 0,192429 & 3351,4844 & 0,184338 & 3528,152 \\ \hline
1           & 2             & 0,739256 & 95,272298 & 0,856981 & 143,8209 \\ \hline
2           & 2             & 0,168894 & 63,646040 & 0,201945 & 105,8382 \\ \hline
3           & 2             & 0,137727 & 61,419863 & 0,162430 & 98,17335 \\ \hline
4           & 2             & 0,126977 & 61,709695 & 0,142167 & 95,45892 \\ \hline
5           & 2             & 0,126977 & 60,580812 & 0,119786 & 94,30556 \\ \hline
6           & 2             & 0,094504 & 58,016983 & 0,102434 & 94,13060 \\ \hline
7           & 2             & 0,087338 & 54,553169 & 0,094258 & 95,13685 \\ \hline
1           & 3             & 0,560965 & 26,557458 & 0,476535 & 16,92936 \\ \hline
2           & 3             & 0,124306 & 7,4053656 & 0,145040 & 7,101954 \\ \hline
3           & 3             & 0,088825 & 6,0982216 & 0,096317 & 5,610379 \\ \hline
4           & 3             & 0,082060 & 5,9523344 & 0,088810 & 6,024141 \\ \hline
5           & 3             & 0,079970 & 5,9452094 & 0,088762 & 6,449547 \\ \hline
6           & 3             & 0,073956 & 5,8366981 & 0,087062 & 6,837013 \\ \hline
7           & 3             & 0,068307 & 5,8796758 & 0,083175 & 7,548662 \\ \hline
1           & 4             & 0,516152 & 16,181090 & 0,463793 & 17,77567 \\ \hline
2           & 4             & 0,113170 & 1,5950891 & 0,132918 & 3,520479 \\ \hline
3           & 4             & 0,070983 & 0,3884387 & 0,079609 & 0,897126 \\ \hline
4           & 4             & 0,054870 & 0,1347170 & 0,063510 & 0,265471 \\ \hline
5           & 4             & 0,047439 & 0,0838274 & 0,053038 & 0,121022 \\ \hline
6           & 4             & 0,044340 & 0,0722532 & 0,049171 & 0,128396 \\ \hline
7           & 4             & 0,041803 & 0,0663301 & 0,047578 & 0,107348 \\ \hline
1           & 5             & 0,515765 & 16,509501 & 0,504384 & NaN      \\ \hline
2           & 5             & 0,110316 & 1,5825358 & 0,220897 & 8,294780  \\ \hline
3           & 5             & 0,069790 & 0,4183520 & 0,137790 & 3,929592 \\ \hline
4           & 5             & 0,054334 & 0,1472888 & 0,085280 & 1,315189  \\ \hline
5           & 5             & 0,047204 & 0,0875447 & 0,061951 & 0,442053 \\ \hline
6           & 5             & 0,044105 & 0,0728900 & 0,052668 & 0,164464 \\ \hline
7           & 5             & 0,041573 & 0,0653133 & 0,049482 & 0,137977 \\ \hline
1           & 6             & 0,512380 & 16,585847 & 0,802075 & 30,13800  \\ \hline
2           & 6             & 0,109809 & 1,5548298 & 0,275403 & 10,24671 \\ \hline
3           & 6             & 0,069306 & 0,4301349 & 0,149532 & 4,201639 \\ \hline
4           & 6             & 0,054169 & 0,1511888 & 0,103317 & 1,791728 \\ \hline
5           & 6             & 0,047103 & 0,0886086 & 0,075372 & 0,813954 \\ \hline
6           & 6             & 0,043868 & 0,0743893 & 0,064577 & 0,458758 \\ \hline
7           & 6             & 0,041327 & 0,0652988 & 0,056781 & NaN      \\ \hline
1           & 7             & 0,511842 & 16,900691 & 0,802075 & 48,72527 \\ \hline
2           & 7             & 0,107107 & 1,3500132 & 0,275403 & 12,81880  \\ \hline
3           & 7             & 0,068103 & 0,4251991 & 0,149532 & 20,67174  \\ \hline
4           & 7             & 0,053561 & 0,1527106 & 0,103317 & 2,522799 \\ \hline
5           & 7             & 0,046666 & 0,0884724 & 0,075372 & 5,458263  \\ \hline
6           & 7             & 0,043484 & 0,0730233 & 0,064577 & 2,037511  \\ \hline
7           & 7             & 0,040960 & 0,0643696 & 0,056781 & 2,961261  \\ \hline
\end{tabular}
\end{table}



\subsubsection{Finalny model wielomianowy}

Najmniejszy błąd na zbiorze weryfikacyjnym uzyskałem dla modelu o rzędzie 7 i stopniu wielomianu 4. Liczba współczynników tego modelu wynosi 56. W mojej opinii jest to duża liczba i dlatego lepiej jako finalny wybrać model o rzędzie piątym i tym samym stopniu wielomianu. Różnica w błędzie między modelami jest niewielka ale za to liczba współczynników modelu spadła do 40.
\bigskip

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/dyn/nonlindyn_arx_ucz_5_deg_4.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}
\newpage
\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/dyn/nonlindyn_oe_ucz_5_deg_4.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/dyn/nonlindyn_arx_wer_5_deg_4.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.9\textwidth]{../figures/dyn/nonlindyn_oe_wer_5_deg_4.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsection{Modele o mieszanej strukturze}
Przed zatwierdzeniem modelu z poprzedniego zadania, warto zbadać modele o mieszanej strukturze. Takie modele zawierają wyrazy typu $y[k-1]u[k-1]$. Z racji na mnogość takich modeli zdecydowałem się na badanie modelów typu wielomian + $a_iy[k-1]u[k-1] + a_{i+1}y[k-2]u[k-2]$. Uzyskane wyniki zamieściłem w tabeli.

\begin{table}[H]
\centering
\caption{Błędy modeli z wyrazami mieszanymi}
\begin{tabular}{|l|l|l|l|l|}
\hline
Rząd modelu & $E_{ucz}^{ARX}$   & $E_{ucz}^{OE}$   & $E_{wer}^{ARX}$   & $E_{wer}^{OE}$   \\ \hline
2           & 0,159679 & 34,3050 & 0,200811 & 84,6176 \\ \hline
3           & 2308,899 & NaN     & 96535,51 & NaN     \\ \hline
4           & 47,59800 & NaN     & 22,55147 & NaN     \\ \hline
5           & 0,643262 & 51,8554 & 0,387773 & 30,4420 \\ \hline
6           & 13,01574 & NaN     & 6,939188 & NaN     \\ \hline
7           & 0,810860 & 14,4081 & 0,835070 & 9,96780 \\ \hline
\end{tabular}
\end{table}

Jak widać na powyższym zestawieniu, zabieg ten nie poprawił jakości uzyskanego wcześniej rozwiązania. Co więcej, w połowie przypadków błąd interesującego nas modelu jest rozbieżny. Poniżej na wykresach zamieściłem odpowiedzi najlepszego modelu z mieszanymi wyrazami.

 \begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlin_mix_dyn_arx_coeff_6.pdf}
\caption{Model ARX (bez rekurencji) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlin_mix_dyn_oe_coeff_6.pdf}
\caption{Model OE (z rekurencją) dla danych uczących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlin_mix_dyn_arx_wer_coeff_6.pdf}
\caption{Model ARX (bez rekurencji) dla danych weryfikujących}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/nonlin_mix_dyn_oe_wer_coeff_6.pdf}
\caption{Model OE (z rekurencją) dla danych weryfikujących}
\end{figure}

\subsection{Podsumowanie}
Ostatecznie, biorąc pod uwagę błędy modeli uzyskane na zbiorze danych weryfikujących i liczbę współczynników modelu, pozostaję przy wcześniej opisanym modelu o rzędzie piątym i czwartym stopniu wielomianu. Jest on opisany równaniem:

$$ 
y[k] = 
\left[\begin{array}{c}
-0,00437\\
0,009436\\
0,009991\\
-0,01366\\
-0,02324\\
-0,10975\\
0,024783\\
0,047855\\
-0,03800\\
-0,12847\\
0,045590\\
0,047818\\
-0,03358\\
-0,08300\\
0,042046\\
0,019747\\
-0,01455\\
-0,05451\\
0,019771\\
0,020342\\
0,500728\\
0,074039\\
0,061178\\
0,013292\\
0,343576\\
-0,22313\\
-0,17283\\
-0,03652\\
0,305840\\
0,204970\\
0,151445\\
0,032141\\
-0,01918\\
-0,08662\\
-0,04533\\
-0,00832\\
-0,22209\\
0,029860\\
0,005184\\
-0,00063\\
\end{array} \right]
\cdot
\left[\begin{array}{c}
   u[k-1] \\
   u[k-2] \\
   u[k-3] \\ 
   u[k-4] \\ 
   u[k-5] \\ 
   (u[k-1])^2 \\
   (u[k-2])^2 \\
   (u[k-3])^2 \\ 
   (u[k-4])^2 \\ 
   (u[k-5])^2 \\ 
   (u[k-1])^3 \\
   (u[k-2])^3 \\
   (u[k-3])^3 \\ 
   (u[k-4])^3 \\ 
   (u[k-5])^3 \\
   (u[k-1])^4 \\
   (u[k-2])^4 \\
   (u[k-3])^4 \\ 
   (u[k-4])^4 \\ 
   (u[k-5])^4 \\
   y[k-1] \\
   y[k-2] \\
   y[k-3] \\ 
   y[k-4] \\ 
   y[k-5] \\ 
   (y[k-1])^2 \\
   (y[k-2])^2 \\
   (y[k-3])^2 \\ 
   (y[k-4])^2 \\ 
   (y[k-5])^2 \\ 
   (y[k-1])^3 \\
   (y[k-2])^3 \\
   (y[k-3])^3 \\ 
   (y[k-4])^3 \\ 
   (y[k-5])^3 \\
   (y[k-1])^4 \\
   (y[k-2])^4 \\
   (y[k-3])^4 \\ 
   (y[k-4])^4 \\ 
   (y[k-5])^4 \\
\end{array} \right]^T
$$
\chapter{Zadanie dodatkowe}

\section{Charakterystyka statyczna}
Ostatnim zadaniem w ramach projektu było wyznaczenie statycznej charakterystyki wyznaczonego modelu. Wyznaczenie tej charakterystyki jest zagadnieniem nietrywialnym. Aby wyznaczyć taką charakterystykę należy założyć że wejście i wyjście procesu są stałe. Następnie należy rozwiązać szereg równań nieliniowych dla interesującego zakresu sygnału sterującego. Do rozwiązania tego problemu użyłem polecenia matlaba \texttt{fsolve}. Uzyskana charakterystyka znajduje się na rysunku poniżej.

\begin{figure}[H]
\centering
\includegraphics[width = 0.85\textwidth]{../figures/dyn/chtyka_stat_mod_nielin.pdf}
\caption{Charakterystyka statyczna modelu regresyjnego}
\end{figure}

Korzystając ze wcześniej napisanych skryptów do obliczania statycznych modeli regresyjnych udało mi się otrzymać następujący wzór tej charakterystyki w zakresie sterowań od $[-1, 1]$:
\begin{equation*}
y(u) = -1,358 \cdot 10^{-6}u^4 + 0,1252u^3 + 0,40309u^2 - 0,15647u -0,134302
\end{equation*}
\end{document}